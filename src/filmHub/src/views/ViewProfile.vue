<template>
  <div class="cinesphere">
    <HeaderPage /> <!-- Agrega el componente HeaderPage -->
    <main class="main-content">

      <div class="container">
        <div class="feed">
          <div class="post" v-for="post in posts" :key="post.id">
            <div class="post-content">
              <img :src="post.moviePoster" :alt="post.movieTitle" class="movie-poster" />
              <div class="post-details">
                <div class="post-higher">
                  <div class="post-header">
                    <img :src="post.user.avatar" :alt="post.user.username" class="avatar" />
                    <div class="user-info">
                      <span class="username">{{ post.user.username }}</span>
                      <span class="timestamp">{{ post.timestamp }}</span>
                    </div>

                  </div>
                  <div class="post-actions">
                    <button  :class="['action-button', post.isFollowing ? 'following' : 'not-following']"
                     @click="toggleFollow(post)">
                      {{ post.isFollowing ? 'Following' : 'Follow' }}
                    </button>
                  </div>
                </div>
                <div class="movie-info">
                  <h3 class="movie-title">{{ post.movieTitle }}</h3>
                  <div class="rating">
                    <span v-for="n in 5" :key="n" class="star" :class="{ 'filled': n <= post.rating }">★</span>
                  </div>
                </div>
                <p class="review">{{ post.review }}</p>


              </div>
            </div>
          </div>

        </div>
        <aside class="sidebar">
          <div class="user-profile">
            <img :src="require('@/assets/foto_perfil.png')" alt="Your profile" class="avatar" />
            <h2>Your Profile</h2>
            <p>@cinephile42</p>
            <div class="stats">
              <div class="stat">
                <span class="stat-value">152</span>
                <span class="stat-label">Reviews</span>
              </div>
              <div class="stat">
                <span class="stat-value">1.2k</span>
                <span class="stat-label">Followers</span>
              </div>
              <div class="stat">
                <span class="stat-value">890</span>
                <span class="stat-label">Following</span>
              </div>
            </div>
          </div>
          <div class="trending-movies">
            <h4>Recently rated movies</h4>
            <ul>
              <li v-for="movie in trendingMovies" :key="movie.id">
                <img :src="movie.poster" :alt="movie.title" class="movie-thumbnail" />
                <div class="movie-info">
                  <span class="movie-title">{{ movie.title }}</span>
                  <div class="rating">
                    <span v-for="n in 5" :key="n" class="star" :class="{ 'filled': n <= movie.rating }">★</span>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </main>
  </div>
</template>

<script>
import HeaderPage from '@/components/HeaderPage.vue'; // Importa el componente HeaderPage
export default {
  name: 'ViewProfile',
  components: {
    HeaderPage, // Registra el componente HeaderPage
  },
  data() {
    return {
      searchQuery: '',
      posts: [
        {
          id: 1,
          user: {
            username: 'moviebuff99',
            avatar: require('@/assets/foto_perfil.png')
          },
          movieTitle: 'Inception',
          moviePoster: require('@/assets/inception_banner.jpg'),
          rating: 5,
          review: "Mind-bending masterpiece! Christopher Nolan outdoes himself with this intricate plot and stunning visuals. A must-watch for any sci-fi fan.",
          timestamp: '2 hours ago',
          isFollowing: true,
        },
        {
          id: 2,
          user: {
            username: 'filmcritic22',
            avatar: require('@/assets/foto_perfil.png')
          },
          movieTitle: 'Bullet Train',
          moviePoster: require('@/assets/bulletTrain_banner.jpg'),
          rating: 5,
          review: "A timeless classic that set the standard for crime dramas. Marlon Brando's performance is unforgettable. Every frame is a masterpiece.",
          timestamp: '5 hours ago',
          isFollowing: false,
        },
        {
          id: 3,
          user: {
            username: 'cinephile42',
            avatar: require('@/assets/foto_perfil.png')
          },
          movieTitle: 'Bohemian Rhapsody',
          moviePoster: require('@/assets/bohemianRhapsody_banner.jpg'),
          rating: 4,
          review: "Tarantino's non-linear storytelling at its finest. The dialogue is sharp, the characters are unforgettable, and the soundtrack is perfect.",
          timestamp: '1 day ago',
          isFollowing: false,
        },

      ],
      trendingMovies: [
        { id: 1, title: 'Dune 2', poster: require('@/assets/dunePartTwo_cover.jpg'), rating: 4 },
        { id: 2, title: 'Barbie', poster: require('@/assets/barbie_cover.jpg'), rating: 4 },
        { id: 3, title: 'Inception', poster: require('@/assets/inception_cover.jpg'), rating: 5 }
      ]
    }
  },
  methods: {
    handleSearch() {
      console.log('Searching for:', this.searchQuery);
    },
    filterPosts() {
      const query = this.searchQuery.toLowerCase();
      this.posts = this.originalPosts.filter(post =>
        post.movieTitle.toLowerCase().includes(query) ||
        post.review.toLowerCase().includes(query) ||
        post.user.username.toLowerCase().includes(query)
      );
    },

    toggleFollow(post) {
      post.isFollowing = !post.isFollowing;
    }
  },
  mounted() {
    // Keep a copy of the original posts for filtering
    this.originalPosts = [...this.posts];
  }

}
</script>

<style scoped>
.cinesphere {
  background-color: #121212;
  color: #ffffff;
  font-family: Arial, sans-serif;

}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}

.main-content {
  padding: 20px 0;
}

.main-content .container {
  display: flex;
  gap: 20px;
  margin-top:5rem;
}

.feed {
  flex: 1;
  max-height: 100%;
  overflow-y: auto;
}

.post {
  display: flex;
  background-color: #1a1a1a;
  border-radius: 10px;
  margin-bottom: 20px;
  padding: 15px;
  gap: 15px;
  align-items: flex-start;
}

.post-header {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  justify-content: flex-start;

}

.post-higher {
  display: flex;
  justify-content: space-between;
}


.avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  margin-right: 10px;
}

.username {
  font-weight: bold;
}

.timestamp {
  font-size: 12px;
  color: #888;
  margin-left: 10px;
}

.post-content {
  display: flex;
  flex: 1;
  gap: 15px;
}

.movie-poster {
  width: 100px;
  height: 150px;
  object-fit: cover;
  border-radius: 10px;
  flex-shrink: 0;
}

.movie-title {
  font-size: 18px;
  margin-bottom: 5px;
}

.rating {
  margin-bottom: 10px;
}

.star {
  color: #888;
  font-size: 18px;
}

.star.filled {
  color: #ffc107;
}

.review {
  font-size: 14px;
  line-height: 1.4;
}

.post-actions {
  display: flex;
  gap: 15px;
  margin-top: auto;
  /* Push actions to the bottom */
}

.post-details {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.action-button {
  margin-left: auto;
  padding: 8px 12px;
  border-radius: 5px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.3s, color 0.3s;
  border: none;
  min-width: 100px;
}

.action-button.following {
  background-color: #d21bd8; /* Violet for "Following" */
  color: #ffffff;
}

.action-button.following:hover {
  background-color: #b700d6; /* Darker violet on hover */
}

.action-button.not-following {
  background-color: #cccccc; /* Light gray for "Not Following" */
  color: #000000;
}

.action-button.not-following:hover {
  background-color: #b3b3b3; /* Darker gray on hover */
}


.sidebar {
  width: 300px;
}

.user-profile {
  background-color: #1a1a1a;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  margin-bottom: 20px;
}

.user-profile .avatar {
  width: 80px;
  height: 80px;
  margin-bottom: 10px;
}

.user-profile h2 {
  margin-bottom: 5px;
}

.user-profile p {
  color: #888;
  margin-bottom: 15px;
}

.stats {
  display: flex;
  justify-content: space-around;
}

.stat {
  text-align: center;
}

.stat-value {
  font-size: 18px;
  font-weight: bold;
  display: block;
}

.stat-label {
  font-size: 12px;
  color: #888;
}

.trending-movies {
  background-color: #1a1a1a;
  border-radius: 10px;
  padding: 20px;
}

.trending-movies h3 {
  margin-bottom: 15px;
}

.trending-movies ul {
  list-style: none;
  padding: 0;
}

.trending-movies li {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.movie-thumbnail {
  width: 60px;
  height: 90px;
  object-fit: cover;
  border-radius: 5px;
  margin-right: 10px;
}

.trending-movies .movie-info {
  flex: 1;
}

.trending-movies .movie-title {
  font-size: 14px;
  margin-bottom: 5px;
}

.trending-movies .rating {
  font-size: 12px;
}

@media (max-width: 768px) {
  .main-content .container {
    flex-direction: column;
  }

  .sidebar {
    width: 100%;
  }

  .search-bar {
    display: none;
  }
}

.search-bar-wrapper {
  margin-bottom: 20px;
}

.search-bar {
  display: flex;
  align-items: center;
  background-color: #2c2c2c;
  border-radius: 10px;
  padding: 5px 15px;
  max-width: 400px;
  margin: 0 auto;
  /* Centers the search bar */
}

.search-input {
  background: none;
  border: none;
  color: #ffffff;
  padding: 8px;
  flex: 1;
  font-size: 14px;
  outline: none;
}

.search-button {
  background: none;
  border: none;
  color: #ff4081;
  font-size: 18px;
  cursor: pointer;
}
</style>